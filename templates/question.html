
{% extends "layout.html" %}
{% block title %}{{ title }}{% endblock %}

{% block content %}
<!--script src="{{ url_for('static', filename='script.js')}}">-->
<script src="{{url_for('static', filename='script.js')}}"></script>
<div class="wrapper">
    
    <!-- Error messages in a loop with classes: error, success -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
            <p class="{{ category }}">{{ message }}</p>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <h1>{{ question[4] }}</h1>
    <h5>Question: {{ question_id }} | Views: {{ question[2] }} | Submission: {{ question[1] }}</h5>
        <form action="">
            <p class="actionbuttons">
                <input type="submit" value="Edit question" name="submit1" class= "cta" id="submit1" formaction="{{ url_for('show_edit_question_form', question_id=question_id) }}">

                <input type="submit" value="Delete question" name="submit2" class= "delete_button" id="submit2" formaction="{{ url_for('delete_question', question_id=question_id) }}">

                <input type="submit" value="Add answer" name="submit3" class= "cta" id="submit3" formaction="{{ url_for('show_new_answer_form', question_id=question_id) }}">

                <input type="submit" value="Back to Questions" name="submit4" class= "cta" id="submit4" formaction="{{ url_for('show_question_list') }}">
            </p>
        </form>
    <p class="description">{{ question[5] }}</p>

    <div class="voter">
        <a href="{{ url_for('vote', direction='up', question_id=question_id) }}" class="voteup">VOTE UP</a>
        <span class="votecounter"> {{ question[3] }} </span>
        <a href="{{ url_for('vote', direction='down', question_id=question_id) }}" class="votedown">VOTE DOWN</a>
    </div>

    {% if question[6] %}
        <h3>Attachment</h3>
        <img src="{{ url_for('static',filename='uploads/' + question[6]) }}" alt="Question Image">
    {% endif %}

    <div class = "q_comments">
         <button onclick="hideMe()" class="cta">Add comment</button>
         <form action="{{ url_for('add_comment', question_id=question_id) }}" method="POST" enctype='multipart/form-data'>
            <div id="q_comment">
                <textarea class="textarea"></textarea><br>
                <input type="submit" value="Submit comment" name="submit_q_comment" class="cta">
            </div>
        </form>
        {% if comments %}
        <h3>Comments</h3>
        {% endif %}
        
    </div>

    {% if answers %}
    <hr>
    <h3>Answers</h3>
        {% for answer in answers %}
        <p class="comment">{{ answer[4] }}</p>
        <div class="voter-mini">
            <a href="{{ url_for('vote', direction='up', answer_id=answer[0]) }}" class="voteup-mini">▲</a>
            <a href="{{ url_for('vote', direction='down', answer_id=answer[0]) }}" class="votedown-mini">▼</a>
        </div>
        <h5><a href="{{ url_for('delete_answer', answer_id=answer[0]) }}" class="delete_mini">✖ Delete</a>Submission: {{ answer[1] }} | Votes: {{ answer[2] }}</h5>
        
        {% if answer[5] %}
            <img src="{{ url_for('static',filename='uploads/' + answer[5]) }}" alt="Answer Image">
        {% endif %}

        {% endfor %}
    {% endif %}
</div>
{% endblock %}
